generator client {
  provider = "prisma-client-py"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Contract {
  id                String   @id @default(uuid())
  contract_hash     String
  network           String
  chain             String   @default("neo")
  monitoring_events String[]
  owner_email       String
  active            Boolean  @default(true)
  contract_name     String?
  risk_level        Int      @default(0)
  breach_vectors    String[]
  formatted_report  String?
  created_at        DateTime @default(now())
  events            Event[]
}

model Event {
  id                 String   @id @default(uuid())
  contract_id        String
  contract           Contract @relation(fields: [contract_id], references: [id], onDelete: Cascade)
  event_name         String
  timestamp          Int
  raw_event          Json
  severity           String?
  breach_detected    Boolean  @default(false)
  recommended_action String?
  created_at         DateTime @default(now())
}

model Metric {
  key        String   @id
  value      Int      @default(0)
  updated_at DateTime @updatedAt
}
